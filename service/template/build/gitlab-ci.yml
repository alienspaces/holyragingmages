
build-template:
  stage: build
  image: docker:19.03.5
  services:
    - docker:19.03.5-dind
  script:
    - docker version
    - echo "CI_REGISTRY       $CI_REGISTRY"
    - echo "CI_REGISTRY_IMAGE $CI_REGISTRY_IMAGE"
    - echo "CI_BUILD_TAG      $CI_BUILD_TAG"
    # - docker build -t $CI_REGISTRY_IMAGE:latest .
    # # push only for tags
    # - "[[ -z $CI_BUILD_TAG ]] && exit 0"
    # - docker tag $CI_REGISTRY_IMAGE:latest $CI_REGISTRY_IMAGE:$CI_BUILD_TAG
    # - docker login -u gitlab-ci-token -p $CI_BUILD_TOKEN $CI_REGISTRY
    # - docker push $CI_REGISTRY_IMAGE:$CI_BUILD_TAG
  tags:
    - docker
